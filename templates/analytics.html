{% extends "base.html" %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/analytics.css') }}">
{% endblock %}

{% block content %}
<div class="main-body">
    <header>
        <h1>Your Progress Analytics</h1>
        <p class="tagline">Track your study performance over time</p>
    </header>

    <section class="analytics-section">
        <div class="analytics-controls">
            <h2 class="section-title">
                <span class="icon">üéõ</span>
                Range Control
            </h2>
            <div class="control-group">
                <label for="sessions-range">Show last:</label>
                <select id="sessions-range">
                    <option value="5" selected>5 sessions</option>
                    <option value="10">10 sessions</option>
                    <option value="20">20 sessions</option>
                    <option value="all">All sessions</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="time-period">Time period:</label>
                <select id="time-period">
                    <option value="7">Last 7 days</option>
                    <option value="30" selected>Last 30 days</option>
                    <option value="90">Last 90 days</option>
                    <option value="365">Last year</option>
                    <option value="all">All time</option>
                </select>
                <button id="apply-analytics-filters" class="apply-btn" hidden>Apply Filters</button>
            </div>
        </div>
        <div class="analytics-card">
            <h2 class="section-title">
                <span class="icon">üìà</span>
                Performance & Efficiency Over Time
            </h2>
            
            <div class="stats-summary">
                <div class="stat-card">
                    <span class="stat-value" id="total-questions">0</span>
                    <span class="stat-label">Total Questions</span>
                </div>
                <div class="stat-card">
                    <span class="stat-value" id="average-score">0%</span>
                    <span class="stat-label">Average Score</span>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="progress-chart"></canvas>
            </div>
        </div>

        <!-- Time Efficiency -->
        <div class="analytics-card">
            <h3>‚è±Ô∏è Time Efficiency</h3>
            <div class="time-metrics">
                <div class="metric">
                    <span class="metric-value" id="avg-time-per-question">0s</span>
                    <span class="metric-label">Avg Time/Question</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="avg-session-time">0m</span>
                    <span class="metric-label">Avg Session Time</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="questions-per-hour">0</span>
                    <span class="metric-label">Questions/Hour</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="success-rate">0%</span>
                    <span class="metric-label">Success Rate (80%+)</span>
                </div>
            </div>
        </div>
        <!-- NEW: Advanced Analytics Section -->
        <div class="advanced-analytics">          
            <!-- Question Type Performance -->
            <div class="analytics-card">
                <h3>üìä Performance by Question Type</h3>
                <div class="chart-container">
                    <canvas id="type-performance-chart"></canvas>
                </div>
            </div>

            <!-- Difficulty Performance -->
            <div class="analytics-card">
                <h3>üéØ Performance by Difficulty</h3>
                <div class="chart-container">
                    <canvas id="difficulty-chart"></canvas>
                </div>
            </div>

            <!-- Progress Trends -->
            <div class="analytics-card full-width">
                <h3>üìà Study Volume & Session Length</h3>
                <div class="stats-summary">
                    <div class="stat-card">
                        <span class="stat-value" id="sessions-count">0</span>
                        <span class="stat-label">Study Sessions</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="total-study-time">0h 0m</span>
                        <span class="stat-label">Total Study Time</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="trends-chart"></canvas>
                </div>
            </div>
        </div>
    </section>
</div>
{% endblock %}